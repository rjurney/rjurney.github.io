<html>
<head>
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
</head>
<body>
Below is a utility script for turning an array of json objects into Tab-Separated-Value (TSV) format. I got tired of doing this in throwaway scripts and finally wrote a utility, and I gift it unto thee!

<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">#!/usr/bin/env python</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">sys</span><span style="color: #333333">,</span> <span style="color: #0e84b5; font-weight: bold">os</span><span style="color: #333333">,</span> <span style="color: #0e84b5; font-weight: bold">re</span><span style="color: #333333">,</span> <span style="color: #0e84b5; font-weight: bold">json</span><span style="color: #333333">,</span> <span style="color: #0e84b5; font-weight: bold">argparse</span>

<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">json_file_2_array</span>(path):
  text <span style="color: #333333">=</span> <span style="color: #007020">open</span>(path)<span style="color: #333333">.</span>read()
  <span style="color: #008800; font-weight: bold">return</span> json<span style="color: #333333">.</span>loads(text)

<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">json_cr_file_2_array</span>(path):
  ary <span style="color: #333333">=</span> []
  f <span style="color: #333333">=</span> <span style="color: #007020">open</span>(path)
  <span style="color: #008800; font-weight: bold">for</span> line <span style="color: #000000; font-weight: bold">in</span> f:
    record <span style="color: #333333">=</span> json<span style="color: #333333">.</span>loads(line<span style="color: #333333">.</span>rstrip(<span style="background-color: #fff0f0">"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">|</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\r</span><span style="background-color: #fff0f0">"</span>))
    ary<span style="color: #333333">.</span>append(record)
  <span style="color: #008800; font-weight: bold">return</span> ary

parser <span style="color: #333333">=</span> argparse<span style="color: #333333">.</span>ArgumentParser(description<span style="color: #333333">=</span><span style="background-color: #fff0f0">'This is a script to turn JSON to TSV with a header row.'</span>)
parser<span style="color: #333333">.</span>add_argument(<span style="background-color: #fff0f0">'-f'</span>,<span style="background-color: #fff0f0">'--file'</span>, help<span style="color: #333333">=</span><span style="background-color: #fff0f0">"File to convert."</span>, required<span style="color: #333333">=</span><span style="color: #007020">True</span>)
parser<span style="color: #333333">.</span>add_argument(<span style="background-color: #fff0f0">'-j'</span>,<span style="background-color: #fff0f0">'--json'</span>, help<span style="color: #333333">=</span><span style="background-color: #fff0f0">"Read the entire file as a json array."</span>, required<span style="color: #333333">=</span><span style="color: #007020">False</span>, action<span style="color: #333333">=</span><span style="background-color: #fff0f0">"store_true"</span>)
args <span style="color: #333333">=</span> parser<span style="color: #333333">.</span>parse_args()

data <span style="color: #333333">=</span> <span style="color: #007020">None</span>
<span style="color: #008800; font-weight: bold">if</span> args<span style="color: #333333">.</span>json:
  data <span style="color: #333333">=</span> json_file_2_array(args<span style="color: #333333">.</span>file)
<span style="color: #008800; font-weight: bold">else</span>:
  data <span style="color: #333333">=</span> json_cr_file_2_array(args<span style="color: #333333">.</span>file)

<span style="color: #888888"># Get the set of field names occurring in any records</span>
keyset <span style="color: #333333">=</span> <span style="color: #007020">set</span>()
<span style="color: #008800; font-weight: bold">for</span> d <span style="color: #000000; font-weight: bold">in</span> data:
  keys <span style="color: #333333">=</span> d<span style="color: #333333">.</span>keys()
  <span style="color: #008800; font-weight: bold">for</span> key <span style="color: #000000; font-weight: bold">in</span> keys:
    keyset<span style="color: #333333">.</span>add(key)

<span style="color: #888888"># Print header</span>
<span style="color: #008800; font-weight: bold">print</span> <span style="background-color: #fff0f0">"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\t</span><span style="background-color: #fff0f0">"</span><span style="color: #333333">.</span>join(keyset)

<span style="color: #008800; font-weight: bold">for</span> d <span style="color: #000000; font-weight: bold">in</span> data:
  row <span style="color: #333333">=</span> []
  <span style="color: #008800; font-weight: bold">for</span> key <span style="color: #000000; font-weight: bold">in</span> keyset:
    key_or_empty <span style="color: #333333">=</span> <span style="color: #007020">str</span>(d[key]) <span style="color: #008800; font-weight: bold">if</span> key <span style="color: #000000; font-weight: bold">in</span> d <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">''</span>
    row<span style="color: #333333">.</span>append(key_or_empty)
  <span style="color: #008800; font-weight: bold">print</span> <span style="background-color: #fff0f0">"</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\t</span><span style="background-color: #fff0f0">"</span><span style="color: #333333">.</span>join(row)
</pre></div>
</body>
</html>